# CVE
## Vendor
Ethereum blockchain - https://etherscan.io

## Vulnerability Type
Incorrect Access Control

## Abstract
We found an incorrect access control vulnerability in the MultiSigWallet contract on the Ethereum blockchain. The vulnerability is located in the `executeTransaction` function, where an attacker can unexpectedly re-enter the function due to the incorrect management of the transaction's `executed` state.

## Details
The MultiSigWallet contract contains a function `executeTransaction` that allows anyone to execute a confirmed transaction. However, the function contains a flaw that allows an attacker to re-enter the function and execute a transaction multiple times.

In the `executeTransaction` function, the contract calls an external address, which can lead to a reentrancy attack. If the external contract calls `executeTransaction` again in its callback function, a reentrancy attack can occur. This is because when `executeTransaction` is called for the first time, the transaction's `executed` state is set to `true`. However, if `executeTransaction` is called again in the callback function of the external contract, this state will be reset to `false`, allowing the transaction to be executed again.

The attack process is as follows:

**Step 1** The attacker prepares a malicious contract that implements a callback function. This function calls the `executeTransaction` function of the MultiSigWallet contract.

**Step 2** The attacker submits a transaction to the MultiSigWallet contract and gets it confirmed by the required number of owners.

**Step 3** The attacker calls the `executeTransaction` function with the ID of the confirmed transaction. The destination of the transaction is the address of the malicious contract.

**Step 4** The `executeTransaction` function of the MultiSigWallet contract calls the malicious contract by sending Ether to it. This triggers the callback function of the malicious contract.

**Step 5** In its callback function, the malicious contract calls the `executeTransaction` function of the MultiSigWallet contract again. Since the `executed` state of the transaction was reset to `false` after the first call, the transaction can be executed again, leading to a reentrancy attack.

This reentrancy attack allows an attacker to drain Ether from the MultiSigWallet contract, causing significant financial loss to the contract's owners.

## Conclusion
This reentrancy vulnerability allows an attacker to execute a transaction more times than intended. It is caused by the incorrect management of the `executed` state of transactions in the `executeTransaction` function. Even though the function checks whether a transaction has been executed before proceeding, the state is reset after the function calls an external contract, making it vulnerable to reentrancy.

## Reference
https://etherscan.io/address/0xF0C9975eFd521282c2DF55774251912d691aC4d9
