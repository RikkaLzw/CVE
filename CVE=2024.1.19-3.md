# Unauthorized Transfer in ReptilianCoin

## Vendor
Ethereum blockchain

## Vulnerability Type
Incorrect Access Control

## Abstract
The Ethereum smart contract ReptilianCoin (RPTC) was found to have an incorrect access control vulnerability. The contract does not correctly check the status of the `tradingOpen` variable, allowing unauthorized transfer operations when trading is not permitted. This can lead to unexpected behavior and potential loss of assets.

## Details

Contract `ReptilianCoin` contains a `startTrading` function that can set `tradingOpen` to true. However, there is no check on the state of `tradingOpen` in the contract. This may allow users to still perform transfer operations when trading is not permitted. 

```solidity
contract ReptilianCoin {
  ...
  bool tradingOpen = false;
  function startTrading() public onlyOwner {
    tradingOpen = true;
  }
  ...
  function _transfer(address from, address to, uint256 amount) internal {
    require(from != address(0));
    require(amount <= _balances[from]);
    uint256 tax = amount.mul(getFee(from, to)).div(100); 
    emit Transfer(from, to, amount);
    _balances[to] = _balances[to] + amount - tax;
    _balances[from] = _balances[from] - amount;
  }
  ...
}
```

The attack process is as follows:

**Step 1** An attacker calls the `_transfer` function directly or indirectly (through other functions that call `_transfer`), attempting to perform a transfer operation.

**Step 2** The `_transfer` function does not check the state of `tradingOpen`, allowing the transfer operation to proceed even if `tradingOpen` is false.

**Step 3** The transfer operation is completed, potentially leading to unauthorized asset transfers.

## Conclusion

This incorrect access control vulnerability can lead to unauthorized transfers when trading is not permitted. This can result in unexpected behavior and potential loss of assets. The contract should implement appropriate checks on the `tradingOpen` variable before allowing transfer operations to proceed.
